{% extends "base.html" %}
{% block content %}
<div class="nav-bar"><a href="{{ url_for('device_list') }}"><i class="fas fa-chevron-left"></i></a><span>添加</span><span></span></div>
<div class="d-flex flex-column align-items-center justify-content-center h-100 p-4 text-center">
    <i class="fab fa-bluetooth text-primary mb-3" style="font-size: 60px;"></i><h5 id="status">搜索设备</h5>
    <button id="scanBtn" class="btn btn-primary rounded-pill px-5 mt-3">搜索</button>
    <div id="result" class="mt-4 w-100 text-start" style="display:none;"><div class="list-group" id="list"></div></div>
</div>
<script>
    document.getElementById('scanBtn').onclick = async () => {
        const s = document.getElementById('status'), l = document.getElementById('list');
        s.innerText = "扫描中...";
        setTimeout(() => {
            s.innerText = "发现设备"; document.getElementById('result').style.display='block'; document.getElementById('scanBtn').style.display='none';
            l.innerHTML = `<div class='list-group-item d-flex justify-content-between' onclick="bind('Smart Lock')"><span>Smart Lock</span><span class='badge bg-success'>绑定</span></div>`;
        }, 1500);
    };
    function bind(n) { fetch('/api/bind', {method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify({name:n})}).then(()=>window.location.href="{{ url_for('device_list') }}"); }
</script>
{% endblock %}